---
title: Do behaviorally flexible birds diversify habitat use within human-modified landscapes?
author: 
- '[Logan CJ](http://CorinaLogan.com)^1^*'
- '[Lukas D](http://dieterlukas.mystrikingly.com)^1^*'
- 'LeGrande-Rolls C^1^'
- 'Bergeron L^2^'
- 'Folsom M^1^'
- 'Marfori Z^1^'
- '[McCune KB](https://www.kelseymccune.com)^2^'
date: '`r Sys.Date()`'
always_allow_html: yes
output:
  html_document: 
    toc: true
    toc_depth: 4
    toc_float: 
      collapsed: false
    code_folding: hide 
  github_document: 
    toc: true
  pdf_document:
    keep_tex: yes
    latex_engine: xelatex
  md_document: 
    toc: true
bibliography: MyLibrary.bib
csl: https://raw.githubusercontent.com/citation-style-language/styles/master/apa.csl
urlcolor: blue
header-includes:
  - \usepackage[left]{lineno}
  - \linenumbers
  - \usepackage{fancyhdr}
  - \usepackage{pdflscape}
  - \newcommand{\blandscape}{\begin{landscape}}
  - \newcommand{\elandscape}{\end{landscape}}
---

Open... ![](logoOpenAccess.png){width=5%} access ![](logoOpenCode.png){width=5%} [code](https://github.com/corinalogan/grackles/blob/master/Files/Preregistrations/g_flexforaging.Rmd) ![](logoOpenPeerReview.png){width=5%} peer review ![](logoOpenData.png){width=5%} [data]()

&nbsp;

**Affiliations:** 1) Max Planck Institute for Evolutionary Anthropology, Leipzig, Germany, 2) University of California Santa Barbara, USA. *Corresponding author: corina_logan@eva.mpg.de

```{r setup, include=FALSE}
library(knitr)
library(formatR)
knitr::opts_chunk$set(tidy.opts=list(width.cutoff=70),tidy=TRUE) 
#Make code chunks wrap text so it doesn't go off the page when knitting to PDF

knitr::opts_chunk$set(echo=T, include=T, results='asis', warning=F, message=F) 
#sets global options to display code along with the results https://exeter-data-analytics.github.io/LitProg/r-markdown.html
#set echo=F for knitting to PDF (hide code), and echo=T for knitting to HTML (show code)
```

&nbsp;

**This is the post-study manuscript of the preregistration that was pre-study peer reviewed and received an In Principle Recommendation on 6 Aug 2019 by:**

Julia Astegiano and Esther Sebastián Gonzalez (2019) Understanding geographic range expansions in human-dominated landscapes: does behavioral flexibility modulate flexibility in foraging and social behavior? *Peer Community in Ecology*, 100026. [10.24072/pci.ecology.100026](https://doi.org/10.24072/pci.ecology.100026). Reviewers: Pizza Ka Yee Chow and Esther Sebastián González

**Preregistration:** [html](http://corinalogan.com/Preregistrations/g_flexforaging.html), [pdf](https://github.com/corinalogan/grackles/blob/master/Files/Preregistrations/g_flexforagingPassedPreStudyPeerReviewOn6Aug2019.pdf), [rmd](https://github.com/corinalogan/grackles/blob/d17a75c24df4b90aa607eda452f4fcc496ae9409/Files/Preregistrations/g_flexforaging.Rmd)

**Post-study manuscript** (submitted to PCI Ecology for post-study peer review on ?): preprint [pdf]() at EcoEvoRxiv, [html](http://corinalogan.com/Preregistrations/g_flexforaging2h3.html), [rmd](https://github.com/corinalogan/grackles/blob/master/Files/Preregistrations/g_flexforaging2h3.Rmd)


### ABSTRACT

This is one of the first studies planned for our long-term research on the role of behavioral flexibility in rapid geographic range expansions. **Project background:** Behavioral flexibility, the ability to change behavior when circumstances change based on learning from previous experience (@mikhalevich_is_2017), is thought to play an important role in a species' ability to successfully adapt to new environments and expand its geographic range (e.g., @lefebvre1997feeding, @griffin2014innovation, @chow2016practice, @sol2000behavioural, @sol2002behavioural, @sol2005big). However, behavioral flexibility is rarely directly tested at the individual level, thus limiting our ability to determine how it relates to other traits (e.g., behavior, invasion success, diet generalism, foraging techniques, foraging innovations, mortality, brain size), which limits the power of predictions about a species' ability to adapt behavior to new environments. We use great-tailed grackles (a bird species) as a model to investigate this question because they have rapidly expanded their range into North America over the past 140 years (i.e., they increased their nesting range by over 5500% between 1880 and 2000 [@wehtje2003range], [@peer2011invasion]) (Fig. 1). Foraging behavior is considered central to the rapid geographic range expansion of this species and it is thought that they have been so successful by following human urban and agricultural corridors (@wehtje2003range, @peer2011invasion). Therefore, as humans continue to modify landscapes, this increases the amount of suitable grackle habitat. We expect this species to be behaviorally flexible because they are fast at reversal learning (@logan2016behavioral), they often encounter human-made "puzzle boxes" in the wild as they attempt to open packaging to access food when digging through garbage cans and eating at outdoor cafes, and they may track resources across time and space. Results will allow us to determine whether, as predicted by hypotheses and cross-species correlational data, in this expanding species, individual-level variation in flexibility is linked with diet breadth, foraging proficiency, social interactions, habitat use, and movement into new geographic areas. **This investigation**: In this piece of the long-term project, we will assess whether individual performance in experiments that assess behavioral flexibility relates to individual variation in ecological and social behavior in the natural environment. In particular, we aim to determine whether the more behaviorally flexible (measured by reversal learning and solution switching on a multi-access box in a separate [preregistration](https://github.com/corinalogan/grackles/blob/master/EasyToReadFiles/g_flexmanip.md)) grackles have more flexible foraging behavior (eat a larger number of different foods, use a wider variety of foraging techniques), are more flexible in their habitat use (are found in more diverse habitat types, disperse farther from their natal area), and are more flexible in their social relationships (have more or stronger social bonds particularly with less related individuals). We will be able to compare the grackle's ability to adapt behavior according to social context with data from other species, as well as determine whether it is linked with measures of flexibility in asocial contexts.  

We present the results from different hypotheses in separate articles: Hypotheses 1 and 2 are in this article, and Hypothesis 3 is in @logan2022flexforaginghabitatuse.

## INTRODUCTION


### HYPOTHESIS

#### H3: Individuals that are [behaviorally flexible](https://github.com/corinalogan/grackles/blob/master/EasyToReadFiles/g_flexmanip.md) [see @mikhalevich_is_2017 for a detailed definition] will differ in their use of microhabitats within human-modified landscapes (substrate qualification during each focal follow), but the macrohabitat (square kilometer) of each population will not differ in human population density (measured with a GPS point for each focal follow after their release from the aviaries; we measure microhabitat types according to the last substrate the focal individual was seen on at the end of the focal follow: grass, gravel, tree, cement cafe, dumpster, [additional substrates will be added as they are encountered]). Flexibility is measured in aviaries using two paradigms: reversal learning and switching between options on a multi-access box. Although we were only able to find this species in association with human-modified landscapes based on eBird sightings (i.e., there appear to be no forest-based populations), individuals could use these landscapes in a variety of ways. For example, they could specialize on particular foods or at particular types of locations (e.g., foraging exclusively at cafes or in grassy areas), they could generalize across all foods and location types, or they might fall somewhere in between these extremes. 

**P5:** Individuals immigrating into a population are more likely to be flexible, potentially because they need to learn how to obtain resources in an unfamiliar area. Immigrants are individuals who carry many genetic variants (identified using ddRADseq) that are not found in other individuals in this population.

**P5 alternative:** Individuals immigrating into a population are not more likely to be flexible, potentially because the human urban environment is comparable across landscapes. 

**P6:** Flexible individuals will be found more regularly in a wider diversity microhabitats (human-modified substrates including cement, dumpsters or cafes; or natural substrates including grass, shrubs, and trees [additional substrates will be added as they are encountered]) during focal follows.

**P6 alternative:** Flexibility is not associated with presence in diverse microhabitats because the more flexible individuals might specialize in specific foraging strategies best suited to particular microhabitats. 

**P7:** There will be no difference in human population density among the sites for our three grackle populations because all great-tailed grackle populations are highly associated with human-modified landscapes. Human population density per square mile data will be obtained from census information (US census bureau: https://www.census.gov/quickfacts/fact/note/US/LND110210, still looking for a source for Central American countries)

**P8:** Flexible individuals will not be associated with presence in diverse microhabitats not necessarily because they are specialists or generalists in specific foraging strategies, but rather because they may focus on high quality resources in particular habitat types. If this prediction is supported, we will conduct an additional analysis to examine the proportion of focal follows associated with a particular microhabitat type, which will allow us to determine whether the more flexible individuals are associated with particular microhabitats more than the less flexible individuals.


## METHODS

Please see our preregistration that received in principle acceptance at PCI Ecology [PDF](https://github.com/corinalogan/grackles/blob/master/Files/Preregistrations/g_flexforagingPassedPreStudyPeerReviewOn6Aug2019.pdf) for the preregistered methods. We include here a summary of the methods and describe the deviations from the preregistration. We present the results from different hypotheses from the preregistration in two separate articles: Hypotheses 1 and 2 are in this article, and Hypothesis 3 is in @logan2022flexforaginghabitatuse.

### Planned sample and data collection stopping rule

Great-tailed grackles (n > 200) were caught in the wild at three field sites across their geographic range: the center of their original range (at a site to be determined in Central America), the middle of the northward expanding edge (Tempe, Arizona USA), and on the northern expanding edge (Sacramento, California USA). Individuals were identified using colored leg bands in unique combinations, their data collected (blood, feathers, and biometrics), and then they were released back to the wild. Some individuals (64-100, minimum 60) were brought temporarily into aviaries for behavioral testing, and then released back to the wild where the data for this study were collected. We will stop collecting data in April 2023 when the current funding ends, or after data have been collected at all three field sites, whichever date comes first.

 - **Deviation from the plan:** We originally planned to collect data from three field sites: the middle of the northward expanding edge (Tempe, Arizona), on the northern expanding edge (this ended up being in Sacramento, California), and at a site in the center of their original range (Central America). We ended up not being able to run the Central American site because the research station we were planning on using as the base for the site was exposed for having decades of sexual abuse toward women. We did not feel comfortable being at that station or bringing our business there, and it was too late to find another site because they take years to set up. Therefore, we have data only from two field sites and not three. This also means our sample size was not >200 grackles as originally planned. Our sample size ended up being 66 grackles with focal follow data in Arizona and 32 grackles in California, for a total of 98. We had also planned on bringing at least 60 of these grackles into the aviaries for behavioral choice tests. Of the grackles we brought into the aviaries, 49 (20 in Arizona and 19 in California) ended up completing their reversal learning experiment. We stopped collecting data in December 2022 when the California field site's data collection was complete.

#### Open materials

 - [Ethogram](https://docs.google.com/spreadsheets/d/1N8wsA3geaRGlMjRxYTRpdG2i5oCXNGq9zBlTnj02Gho/edit?usp=sharing) for Prim8

 - [Individuals](https://docs.google.com/spreadsheets/d/1Lr0pwsmdnpVM8X2Fyoj9EIGa3zOY1WCZlntW7e0Ui_Y/edit?usp=sharing) for Prim8

 - [Protocol](https://docs.google.com/document/d/1SMUy43qRd52BBTZM5Oe2hpSExBLRAC6iUVyGvrAlgqs/edit?usp=sharing) for cleaning the focal follow data

#### Open data

The data, scripts, and code are available at the Knowledge Network for Biocomplexity's data repository [@logan2022flexforaginghabitatusedata].


#### Dependent variables

***P5: flexible = immigrants***

Probability of being an immigrant (measured using maximum-likelihood-based individual assignment probabilities calculated using an admixture program with the ddRADseq data)

***P6: flexible = wider range of habitats***

Evenness in the proportion of time spent in each habitat type (grass, gravel and other natural substrate, cement, cafe, dumpster)

***P8: flexible = particular habitats***

Proportion of focal follows in each habitat type (grass, gravel and other natural substrate, cement, cafe, dumpster)

#### Independent variables

***P6***

1) Flexibility 1: **Number of trials to reverse** a preference in the last reversal (in the reversal learning experiment) an individual experienced (individuals in the flexibility control group only experience 1 reversal so this data will come from their first and only reversal; individuals in the flexibility manipulation group experience serial reversals until they pass a certain criterion, therefore we will only use data from their most recent reversal). An individual is considered to have a preference if it chose the rewarded option at least 17 out of the most recent 20 trials, with a minimum of 8 or 9 correct choices out of 10 on the two most recent sets of 10 trials). See behavioral flexibility [preregistration](https://github.com/corinalogan/grackles/blob/master/EasyToReadFiles/g_flexmanip.md).

2) Flexibility 3: If the number of trials to reverse a preference does not positively correlate with the number of trials to attempt or solve (meet criterion) new loci on the multi-access box (an additional measure of behavioral flexibility), then the **number of trials to solve** and the **number of trials to attempt** a new option on the multi-access box will be additional dependent variables. See behavioral flexibility [preregistration](https://github.com/corinalogan/grackles/blob/master/EasyToReadFiles/g_flexmanip.md).

3) Flexibility 4: This measure is currently being developed and is intended be a more accurate representation of all of the choices an individual made, as well as accounting for the degree of uncertainty exhibited by individuals as preferences change. It will be based on a Bayesian estimate of the reduction in error across trials estimated from the number of correct choices from the beginning of each reversal. If this measure more effectively represents flexibility (determined using a modeled dataset and not the actual data), we may decide to solely rely on this measure and not use flexibility measures 1 through 3. If this ends up being the case, we will modify the code in the analysis plan below to reflect this change.

4) Flexibility manipulation: control, manipulated

5) Dominance rank: measured as the number of wins minus the number of losses, divided by the sum of wins + losses. This calculation will give each individual a dominance rank number, and we will order individuals by rank from lowest to highest to create a dominance hierarchy.

6) Condition: aviary-tested, not-aviary-tested

7) ID (random effect because multiple measures per individual)

8) Population: center (Central America), middle (Arizona), edge (northern US) (random effect because each population might have a different slope)

***P5: immigrants = more flexible***

1) Flexibility 1: **Number of trials to reverse** a preference in the last reversal an individual experienced (reversal learning; an individual is considered to have a preference if it chose the rewarded option at least 17 out of the most recent 20 trials, with a minimum of 8 or 9 correct choices out of 10 on the two most recent sets of 10 trials). See behavioral flexibility [preregistration](https://github.com/corinalogan/grackles/blob/master/EasyToReadFiles/g_flexmanip.md).

2) Flexibility 3: If the number of trials to reverse a preference does not positively correlate with the latency to attempt or solve new loci on the multi-access box (an additional measure of behavioral flexibility), then the **average latency to solve** and the **average latency to attempt** a new option on the multi-access box will be additional dependent variables. See behavioral flexibility [preregistration](https://github.com/corinalogan/grackles/blob/master/EasyToReadFiles/g_flexmanip.md).

3) Flexibility 4: A Bayesian measure is currently being developed and is intended be a more accurate representation of all of the choices an individual made, as well as accounting for the degree of uncertainty exhibited by individuals as preferences change. If this measure more effectively represents flexibility (determined using a modeled dataset and not the actual data), we may decide to solely rely on this measure and not use flexibility measures 1 through 3. If this ends up being the case, we will modify the code in the analysis plan below to reflect this change.

4) Population: center (Central America), middle (Arizona), edge (northern US) (random effect because each population might have a different slope)

***P8: flexible = particular habitats***

Flexibility 1 (as above)

### E. ANALYSIS PLAN

We do not plan to **exclude** any data. When **missing data** occur, the existing data for that individual will be included in the analyses for the tests they completed. Analyses will be conducted in R (current version `r getRversion()`; @rcoreteam). When there is more than one experimenter within a test, experimenter will be added as a random effect to account for potential differences between experimenters in conducting the tests. If there are no differences between models including or excluding experimenter as a random effect, then we will use the model without this random effect for simplicity.

We will analyze data for females and males separately because each sex has a distinct natural history.

#### Ability to detect actual effects

To begin to understand what kinds of effect sizes we will be able to detect given our sample size limitations and our interest in decreasing noise by attempting to measure it, which increases the number of explanatory variables, we will revise the Analysis Plan after reading @statrethinkingbook. We currently don’t have any estimates for any of our measured variables because these tests have never been done in grackles and we have not encountered previous research that has manipulated flexibility in this way. We will use Bayesian analyses to estimate our likely confidence in the results given simulated data. We will revise this preregistration to include these new analyses before conducting the planned analyses on our actual data. Based on the simulations, we might adapt the number of focal follows per individual or decide to collect much more data just with the aviary-tested birds to increase the amount of information per individual.

#### Data checking

The data will be checked for overdispersion, underdispersion, zero-inflation, and heteroscedasticity with the DHARMa R package [@Hartig2019dharma] following methods by [Hartig](https://cran.r-project.org/web/packages/DHARMa/vignettes/DHARMa.html). Note: DHARMa doesn't support MCMCglmm, therefore we will use the closest supported model: glmer from the R package lme4 [@lme4].

### P5: Flexibility and immigration

The model takes the form of:

$pimmigrant_{i}$ ~ Binomial(1, $p$) *[likelihood]*,

logit($p$) ~ $\alpha_{i}$[habitat] + $\beta_{i}$$\phi$ *[model]*,

where $pimmigrant_{i}$ is the probability of being an immigrant for each individual i, $p$ is the probability of being an immigrant, $\alpha_{i}$ is the intercept (one per observation), and $\beta_{i}$ is the slope for the interaction with $\phi$. Note that the model is the same when analyzing $\lambda$, which replaces $\phi$ in the above model. We determine that $\phi$ and $\lambda$ are strongly related to the probability of being an immigrant if the compatibility interval for the slope does not cross zero.


### P6: Flexibility and habitat diversity

The model takes the form of:

$div_{i}$ ~ Normal($\mu_{i}$, $\sigma_{i}$) *[likelihood]*,

log($\mu_{i}$) ~ $\alpha$ + $\beta_{p}$$\phi$ + $\beta_{r}$$rank$ *[model]*,

where $div_{i}$ is the Shannon Diversity Index [see @vegan for mathematical definition] for each individual i, $\mu_{i}$ is the mean and $\sigma_{i}$ is the standard deviation, $\alpha$ is the intercept, $\beta_{p}$ is the slope for the interaction with $\phi$, and $\beta_{r}$ is the slope for the interaction with dominance $rank$. Note that the model is the same when analyzing $\lambda$, which replaces $\phi$ in the above model. We determine that $\phi$ and $\lambda$ are strongly related to the diversity index if the compatibility interval for the slope does not cross zero.


### P7: human population density across sites

Human population density (population per square mile) is obtained from the U.S. Census Bureau for Tempe, Arizona (https://www.census.gov/quickfacts/fact/table/tempecityarizona,US/POP060220), Woodland, California (https://www.census.gov/quickfacts/fact/table/woodlandcitycalifornia/POP060220), and Sacramento, California (https://www.census.gov/quickfacts/fact/table/sacramentocitycalifornia,tempecityarizona,US/POP060220) for 2010 and 2020 (the Census data), and from the U.S. Census American Community Survey (https://www.opendatanetwork.com/entity/1600000US0664000-1600000US0686328-1600000US0473000/Sacramento_CA-Woodland_CA-Tempe_AZ/geographic.population.density?year=2018&ref=compare-entity) for the rest of the years from 2009 to 2018 (note that there is no data for 2019). The Woodland population consists of two trapping locations: one in Woodland and the other in Sacramento. The two locations represent the same population because some of the same individuals are found at both locations. We design a bespoke Bayesian model to determine whether there are differences between populations and we conduct a simulation to determine how much of a difference between the means (at least 250 people per square mile) would result in there being a difference between the cities.

The model takes the form of:

$p_{i}$ ~ Normal($\mu_{i}$, $\sigma_{i}$) *[likelihood]*,

log($\mu_{i}$) ~ $\alpha$[city]  *[model]*,

where $p_{i}$ is the human population density (total population divided by the land area per square mile) for each observation i, $\mu_{i}$ is the mean and $\sigma_{i}$ is the standard deviation, and $\alpha$[city] is the intercept for each city.

### P8: flexibility and microhabitat types

The model takes the form of:

$follows_{i}$ ~ Binomial(1, $p$) *[likelihood]*,

logit($p$) ~ $\alpha_{i}$[habitat] + $\beta_{i}$$\phi$ *[model]*,

where $follows_{i}$ is the proportion of focal follows that were recorded in a particular microhabitat for each individual i, $p$ is the probability of being in a given microhabitat, $\alpha_{i}$ is the intercept (one per observation), and $\beta_{i}$ is the slope for the interaction with $\phi$. Note that the model is the same when analyzing $\lambda$, which replaces $\phi$ in the above model. We determine that $\phi$ and $\lambda$ are strongly related to the proportion of focal follows in a given habitat if the compatibility interval for the slope does not cross zero.


## RESULTS

### P5: Flexibility and immigration

**Analysis:** Because the independent variables could influence each other, we will analyze them in a single model: Generalized Linear Mixed Model (GLMM; MCMCglmm function, MCMCglmm package; [@hadfield2010mcmc]) with a Poisson distribution and log link using 130,000 iterations with a thinning interval of 10, a burnin of 30,000, and minimal priors (V=1, nu=0) [@hadfield2014coursenotes]. We will ensure the GLMM shows acceptable convergence (lag time autocorrelation values <0.01; [@hadfield2010mcmc]), and adjust parameters if necessary to meet this criterion. We will determine whether an independent variable had an effect or not using the Estimate in the full model.

```{r p5, eval=FALSE, warning=FALSE, results='asis', echo=TRUE, include=TRUE}
library(rethinking)
p5 <- read.csv(url("https://raw.githubusercontent.com/corinalogan/grackles/master/Files/Preregistrations/g_flexforaging_data_general.csv"), header=T, sep=",", stringsAsFactors=F)
p% <- data.frame(p5)

# remove NAs
p5 <- subset(p5,!(is.na(p5["ProbImmigrant"])))
p5 <- subset(p5,!(is.na(p5["Phi"])))
p5 <- subset(p5,!(is.na(p5["Lambda"])))

#Separate the sexes
f5 <- p5[p5$Sex=="F",]
m5 <- p5[p5$Sex=="M",]

#Summary
f5$BirdID <- as.factor(f5$BirdID)
#length(levels(f8$BirdID)) # females
m5$BirdID <- as.factor(m5$BirdID)
#length(levels(m8$BirdID)) # males

# RUN THE MODEL on the actual data (similar to J.Q4 in ManyIndividuals: line 1024)
# MALES, phi. Set up data sheet for model
dat5 <- list(follows = mm8$Probimmigrant, 
            phi = standardize(mm8$Phi),
            lambda = standardize(mm8$Lambda)
              )

# Run the model
m5phi <- ulam( alist(
        follows ~ dbinom(1,p),
        logit(p) <- a + b*phi , #microhabitat=random variable
        a ~ dnorm(0,1) #mean=0 bc response variable is standardized
    ) , data=dat5 , chains=4 , cores=4 , cmdstan = TRUE, control = list(adapt_delta = .95, force_recompile = TRUE))

outputm5p <- precis( m5phi , depth=2 ) #look at the b values (the slopes) and whether the interval crosses zero to 

#GLMM 
#females
f1 <- MCMCglmm(ImmigrantProbability ~ Phi + Lambda, random=~Population, family="poisson", data=fem, verbose=F, prior=prior, nitt=130000, thin=10, burnin=30000)
summary(f1)
#autocorr(f1$Sol) #Did fixed effects converge?
#autocorr(f1$VCV) #Did random effects converge?

#males
f2 <- MCMCglmm(ImmigrantProbability ~ Phi + Lambda, random=~Population, family="poisson", data=mal, verbose=F, prior=prior, nitt=130000, thin=10, burnin=30000)
summary(f2)
#autocorr(f2$Sol) #Did fixed effects converge?
#autocorr(f2$VCV) #Did random effects converge?
```


### P6: flexible = wider range of habitats

The Shannon Diversity Index does not have a strong relationship with either flexibility component, phi or lambda, for either sex as indicated by the low means and the compatibility interval crossing zero (Table X). As such, prediction 6 (the more flexible individuals have a higher diversity index) and prediction 6 alternative (the more flexible individuals have a low diversity index indicating that they are specialists) are not supported.

**Table.** Model output showing that phi and lambda did not have a strong relationship with the Shannon Diversity Index for either sex as indicated by the slopes. n_eff is the effective sample size and Rhat4 is an indicator of model convergence (1.00 is ideal).

```{r resltsp6table, eval=T}
library(kableExtra)
t6 <- read.csv(url("https://raw.githubusercontent.com/corinalogan/grackles/master/Files/Preregistrations/g_flexforaging_tablep6.csv"), header=F, sep=",", stringsAsFactors=F)
t6 <- data.frame(t6)
colnames(t6) <- c("","Mean","Standard deviation","Lower 89 percentile compatibility interval (5.5%)","Upper 89 percentile compatibility interval (94.5%)","n_eff","Rhat4")

knitr::kable(t6) %>%
kable_styling(full_width = T, position = "left",  bootstrap_options = "condensed", font_size = 11)
```

```{r p6, eval=FALSE}
### Calculate the Shannon diversity index (SDI) per bird
sdi <- read.csv(url("https://raw.githubusercontent.com/corinalogan/grackles/master/Files/Preregistrations/g_flexforaging_data_proportionmicrohabitats.csv"), header=T, sep=",", stringsAsFactors=F)
sdi <- data.frame(sdi)
library(vegan)

#factor ID and make a data frame for each individual so each can get their own SDI
sdi$BirdID <- factor(sdi$BirdID)
#levels(unique(sdi$BirdID))
ado <- sdi[sdi$BirdID=="Adobo",]
#diversity(ado$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=0
akx <- sdi[sdi$BirdID=="Ak'xi",]
#diversity(akx$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=0
bun <- sdi[sdi$BirdID=="Buñuelo",]
#diversity(bun$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=0
bur <- sdi[sdi$BirdID=="Burrito",]
#diversity(bur$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=0.748781
cam <- sdi[sdi$BirdID=="Camote",]
#diversity(cam$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=1.386294
cha <- sdi[sdi$BirdID=="Chalupa",]
#diversity(cha$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=1.332179
chi <- sdi[sdi$BirdID=="Chilaquile",]
#diversity(chi$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=0.6341786
cue <- sdi[sdi$BirdID=="Cuervo",]
#diversity(cue$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=1.013665
cut <- sdi[sdi$BirdID=="Cutuy",]
#diversity(cut$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=0.4558862
dia <- sdi[sdi$BirdID=="Diablo",]
#diversity(dia$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=0.9502705
ddl <- sdi[sdi$BirdID=="Dulce de Leche",]
#diversity(ddl$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #= 1.085262
fid <- sdi[sdi$BirdID=="Fideo",]
#diversity(fid$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=1.260804
fla <- sdi[sdi$BirdID=="Flan",]
#diversity(fla$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=0
gal <- sdi[sdi$BirdID=="Galandra",]
#diversity(gal$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=0.872114
hab <- sdi[sdi$BirdID=="Habanero",]
#diversity(hab$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=0
hel <- sdi[sdi$BirdID=="Helado",]
#diversity(hel$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=0.6931472
kau <- sdi[sdi$BirdID=="Kau",]
#diversity(kau$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=0
kel <- sdi[sdi$BirdID=="Kel",]
#diversity(kel$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=1.039721
mar <- sdi[sdi$BirdID=="Marisco",]
#diversity(mar$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=1.039721
mof <- sdi[sdi$BirdID=="Mofongo",]
#diversity(mof$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=1.386294
mol <- sdi[sdi$BirdID=="Mole",]
#diversity(mol$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=0.6931472
pin <- sdi[sdi$BirdID=="Piña",]
#diversity(pin$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=1.098612
piz <- sdi[sdi$BirdID=="Pizza",]
#diversity(piz$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #= 0.6341786
pol <- sdi[sdi$BirdID=="Pollito",]
#diversity(pol$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=0
pov <- sdi[sdi$BirdID=="Polvorones",]
#diversity(pov$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=1.334183
que <- sdi[sdi$BirdID=="Queso",]
#diversity(que$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=0.6730117
tac <- sdi[sdi$BirdID=="Taco",]
#diversity(tac$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=0.748781
tap <- sdi[sdi$BirdID=="Tapa",]
#diversity(tap$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=1.039721
taq <- sdi[sdi$BirdID=="Taquito",]
#diversity(taq$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=0
tem <- sdi[sdi$BirdID=="Tembleque",]
#diversity(tem$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=1.332179
tom <- sdi[sdi$BirdID=="Tomatillo",]
#diversity(tom$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=1.039721
tza <- sdi[sdi$BirdID=="Tzanatl preciosa",]
#diversity(tza$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=0.6931472
xun <- sdi[sdi$BirdID=="Xunub",]
#diversity(xun$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=0.5623351
yuc <- sdi[sdi$BirdID=="Yuca",]
#diversity(yuc$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=0
zan <- sdi[sdi$BirdID=="Zapote Negro",]
#diversity(zan$ProportionFollows, index = "shannon", equalize.groups = FALSE, MARGIN = 1, base = exp(1)) #=1.322879
#entered this data into the main data sheet used below

### RUN THE MODELS
library(rethinking)
p8 <- read.csv(url("https://raw.githubusercontent.com/corinalogan/grackles/master/Files/Preregistrations/g_flexforaging_data_general.csv"), header=T, sep=",", stringsAsFactors=F)
p8 <- data.frame(p8)

# remove NAs
p8 <- subset(p8,!(is.na(p8["ShannonDiversityIndex"])))
p8 <- subset(p8,!(is.na(p8["Phi"])))
p8 <- subset(p8,!(is.na(p8["Lambda"])))
p8 <- subset(p8,!(is.na(p8["DomRank"])))

#Separate the sexes
f8 <- p8[p8$Sex=="F",]
m8 <- p8[p8$Sex=="M",]

#Summary
f8$BirdID <- as.factor(f8$BirdID)
#length(levels(f8$BirdID)) #9 females
m8$BirdID <- as.factor(m8$BirdID)
#length(levels(m8$BirdID)) #26 males

# SIMULATE
n = 100
p = rnorm(n,mean=0,sd=1) #phi can range from 0 to 1, but standardize it by making mean=0 and SD=1. FYI avg phi for AZ grackles is about 0.06 and only goes up to 0.12 so this is a small number, hence the small sd to keep it in this low range. 
d = rnorm(n,mean=0,sd=0.2) #rank can range from 0 to 1, but standardize it
sdi = rnorm(n,mean=(-1*p + 1*d),sd=0.5) #shannon diversity index, standardize it. Now change the slope (b) - tried 0, 1, and -1
#plot(p,sdi)
#plot(d,sdi)
#plots look good - any relationship is possible, but all values are within the feasible range

#Just to check: unstandardize for plotting to interpret: standardized value * sd of original data + mean of original data
pu = sd(m8$Phi)*p+mean(m8$Phi)
sdiu = sd(m8$ShannonDiversityIndex)*sdi+mean(m8$ShannonDiversityIndex)
#plot(pu,sdiu)


# RUN THE MODEL on the actual data (similar to J.Q4 in ManyIndividuals: line 1024)
# MALES, phi. Set up data sheet for model
dat <- list(div = standardize(m8$ShannonDiversityIndex), #range=0-1.54 so standardizing centers on 0
            phi = standardize(m8$Phi),
            lambda = standardize(m8$Lambda),
            rank = standardize(m8$DomRank)
              )

# Run the model: normal distribution bc the index is a variable that has already been modified to account for presence in habitats, therefore it is more similar to a sum (McElreath 2nd edition, Fig 10.6)
m8phi <- ulam(
    alist(
        div ~ dnorm(mu,sigma),
        log(mu) <- a + bp*phi + br*rank ,
        a ~ dnorm(0,1), #mean=0 bc response variable is standardized
        bp ~ dnorm(0,1),
        br ~ dnorm(0,1),
        sigma~dexp(1)
    ) , data=dat , chains=4 , cores=4 , cmdstan = TRUE, control = list(adapt_delta = .95, force_recompile = TRUE))

outputm8p <- precis( m8phi , depth=2 ) #look at the bp effect size and whether the interval crosses zero to determine whether phi is strongly related to the diversity index (does not cross 0) or not (does cross 0). Look at the direction of the relationship to determine whether higher phi (more flexible bc associated with reversing in fewer trials, see Lukas et al. 2023 figs 2 & 3) have lower SDIs, which would indicate that they are specializing in particular microhabitats
#        mean   sd  5.5% 94.5% n_eff Rhat4
#a     -1.87 0.57 -2.82 -1.03  1225  1.00
#bp     0.05 0.55 -0.81  0.92  1127  1.00
#br     0.27 0.51 -0.46  1.11   932  1.01
#sigma  1.04 0.15  0.82  1.30  1474  1.00
# The result here and for all of the below models is the same: bp interval crosses zero and the slope is negative (-0.02 to -0.33) so not much relationship between phi and the shannon diversity index, indicating that the more flexible individuals do not specialize or generalize in microhabitat types, but are somewhere in the middle. This means that P6 and P6 alt are not supported and do not need to be analyzed. Do need to analyze P8 though because can't tell from this analysis whether different birds preferred different habitats. We can only see how they split their time among the habitats, not what the habitats are.


# MALES, lambda
m8lam <- ulam(
    alist(
        div ~ dnorm(mu,sigma),
        log(mu) <- a + bl*lambda + br*rank , #bird=random variable
        a ~ dnorm(0,1), #mean=0 bc response variable is standardized
        bl ~ dnorm(0,1),
        br ~ dnorm(0,1),
        sigma~dexp(1)
    ) , data=dat , chains=4 , cores=4 , cmdstan = TRUE, control = list(adapt_delta = .95, force_recompile = TRUE))

outputm8l <- precis( m8lam , depth=2 ) #look at the bp effect size and whether the interval crosses zero to determine whether 
#       mean   sd  5.5% 94.5% n_eff Rhat4
#a     -1.86 0.58 -2.89 -1.00  1081     1
#bl    -0.02 0.47 -0.83  0.66  1071     1
#br     0.31 0.54 -0.48  1.23  1114     1
#sigma  1.05 0.15  0.83  1.32  1467     1


# FEMALES, phi
daf <- list(div = standardize(f8$ShannonDiversityIndex), #range=0-1.54 so standardizing centers on 0
            phi = standardize(f8$Phi),
            lambda = standardize(f8$Lambda),
            rank = standardize(f8$DomRank)
              )

f8phi <- ulam(
    alist(
        div ~ dnorm(mu,sigma),
        log(mu) <- a + bp*phi + br*rank , #bird=random variable
        a ~ dnorm(0,1), #mean=0 bc response variable is standardized
        bp ~ dnorm(0,1),
        br ~ dnorm(0,1),
        sigma~dexp(1)
    ) , data=daf , chains=4 , cores=4 , cmdstan = TRUE, control = list(adapt_delta = .95, force_recompile = TRUE))

outputfp <- precis( f8phi , depth=2 ) #look at the bp effect size and whether the interval crosses zero to determine whether 
#a     -1.50 0.62 -2.54 -0.61   904     1
#bp    -0.14 0.58 -1.17  0.65   905     1
#br     0.44 0.70 -0.66  1.57  1005     1
#sigma  1.08 0.29  0.71  1.59  1180     1

f8lam <- ulam(
    alist(
        div ~ dnorm(mu,sigma),
        log(mu) <- a + bl*lambda + br*rank , #bird=random variable
        a ~ dnorm(0,1), #mean=0 bc response variable is standardized
        bl ~ dnorm(0,1),
        br ~ dnorm(0,1),
        sigma~dexp(1)
    ) , data=daf , chains=4 , cores=4 , cmdstan = TRUE, control = list(adapt_delta = .95, force_recompile = TRUE))

outputfl <- precis( f8lam , depth=2 ) #look at the bp effect size and whether the interval crosses zero to determine whether 
#       mean   sd  5.5% 94.5% n_eff Rhat4
#a     -1.50 0.60 -2.53 -0.60   975     1
#bl    -0.33 0.59 -1.30  0.59   943     1
#br     0.39 0.65 -0.56  1.47   805     1
#sigma  1.05 0.29  0.69  1.58  1153     1

# the figure
op <- par(mfrow=c(2,2), mar=c(5.9,4.9,2,0.9))
plot(daf$div ~ daf$phi , pch=1 , col="black" , xlab="Female: Phi (standardized)" , ylab="Shannon Diversity Index (standardized)" , xlim=c(-2.5,2.5), cex.lab=2, cex.axis=2, cex=2 )
#mu <- link( f8phi , data=data.frame( trials=trialsp_seq ) )
#mu_mean <- apply( mu , 2 , mean )
#mu_ci <- apply( mu , 2 , PI , prob=0.89 )
#lines( trialsp_seq , mu_mean , lwd=2 )
#shade( mu_ci , unstandardizedtrialseq , col=col.alpha(rangi2,0.3) )
plot(daf$div ~ daf$lambda , pch=1 , col="black" , xlab="Female: Lambda (standardized)" , ylab="Shannon Diversity Index (standardized)", xlim=c(-2,2), cex.lab=2, cex.axis=2, cex=2 )
plot(dat$div ~ dat$phi , pch=1 , col="black" , xlab="Male: Phi (standardized)" , ylab="Shannon Diversity Index (standardized)", xlim=c(-2.5,2.5), cex.lab=2, cex.axis=2, cex=2 )
plot(dat$div ~ dat$lambda , pch=1 , col="black" , xlab="Male: Lambda (standardized)" , ylab="Shannon Diversity Index (standardized)", xlim=c(-2.5,2.5), cex.lab=2, cex.axis=2, cex=2 )
par(op)
```

**Figure.** Scatterplots showing the lack of relationship between the Shannon Diversity Index with $\phi$ and $\lambda$ for both sexes.

This species is primarily found within urbanized environments, however there are many different substrates within urban habitats that could provide a variety of food items. Since we are interested in the flexibility of grackle foraging behaviors within the urban habitat, we have focused our habitat diversity measures on the different substrates on which we are mostly likely to see individual variability in foraging behaviors and food types, if present.  For example, cement, cafe, and dumpster substrates are all likely to contain human-provided food (either because people leave food out for wild animals or wild animals are able to scrounge human foods), whereas grass, gravel, or other natural substrates such as trees likely contain non-human provided prey items including insects and small vertebrates. Using the Shannon diversity index to understand the evenness of substrate use within urban habitats has been recommended by others in the field of urban ecology [@alberti2001quantifying; @tews2004animal].

### P7: no difference in human population density across sites

Human population density (population per square mile) is higher in Sacramento, California (mean=4,895, standard deviation=185), which is higher than Tempe, Arizona (mean=4,283, standard deviation=187), which is higher than Woodland, California (mean=3,710, standard deviation=140) (contrast: mean=572.84 sd=32.21 89% compatibility interval=520.78-622.69).

**Table.** Contrasts showing that the human population density at each trap site is different from the others.

```{r resltsp7table, eval=T}
library(kableExtra)
exptable <- read.csv(url("https://raw.githubusercontent.com/corinalogan/grackles/master/Files/Preregistrations/g_flexforaging_tablep7.csv"), header=F, sep=",", stringsAsFactors=F)
exptable <- data.frame(exptable)
colnames(exptable) <- c("","Mean","Standard deviation","Lower 89 percentile compatibility interval (5.5%)","Upper 89 percentile compatibility interval (94.5%)")

knitr::kable(exptable) %>%
kable_styling(full_width = T, position = "left",  bootstrap_options = "condensed", font_size = 11)
```

```{r p7, eval=FALSE}
library(rethinking)

# Human population density 2009-2020 (but no data for 2019 so n=10 data points per city) from the Open Data Network, which used data from the U.S. Census American Community Survey ("Population Density is computed by dividing the total population by Land Area Per Square Mile"), except for the data points from 2010 and 2020, which were from the census.
pd <- read.csv(url("https://raw.githubusercontent.com/corinalogan/grackles/master/Files/Preregistrations/g_flexforaging_datap7.csv"), header=T, sep=",", stringsAsFactors=F)
pd <- data.frame(pd)

# look at the data: each city's pop is generally increasing every year
f <- plot(pd$HumanPopDensity~pd$Year)

# SIMULATE data to figure out the model boundaries
n=10 #sample size
offset=250 #expect no difference between the cities when offset=0 (bc they have the same means)
city1_mean=5000 #avg pop density of city 1
city2_mean=city1_mean+offset #avg pop density of city 2
act1=rnorm(n/2, mean=city1_mean, sd=100) #alpha simulation for city 1
act2=rnorm(n/2, mean=city2_mean, sd=100) #alpha simulation for city 2

#boxplot(c(act1,act2)~c(rep("City1",n/2),rep("City2",n/2))) #look at the sim
plotsim <- plot(c(act1,act2)~c(rep(1,n/2),rep(2,n/2))) #look at the sim
for (j in 1:(n/2) ) {
  lines(x=c(1,2),y=c(act1[j],act2[j]),lwd=2,col=2)
}

# will run a contrast on the actual data to determine whether the cities differ, so run simulated contrasts and look at the histogram to see if any values cross zero. Centered on the offset and the spread reflects the SD. Ran the contrasts with varying offsets and found the values stop crossing zero when the difference between the city means is at least 250 (at n=50 and n=10, SD always=100).
contrast <- act2-act1
hist(contrast)

# USING ACTUAL DATA: Set up the data sheet for the model
dat <- list(
  city = as.factor(pd$City),
  p = as.numeric(pd$HumanPopDensity)
)

# Run the model: normal distribution bc pop density is a sum with a large mean (McElreath 2nd edition, Fig 10.6)
pop <- ulam(
    alist(
        p ~ dnorm(mu,sigma),
        log(mu) <- a[city],
        a[city] ~ dnorm(8,2), #mean of 8 because the actual mean across the cities is around 3000 so log(3000)=8. Set the sd of expected values at 2 because pop densities could range from 100 (log=5) to 10,000 (log=9)
        sigma~dexp(1)
    ) , data=dat , chains=4 , cores=4 , cmdstan = TRUE, control = list(adapt_delta = .95, force_recompile = TRUE))

output <- precis( pop , depth=2 ) #level 1=Sacramento, 2=Tempe, 3=Woodland
#        mean   sd  5.5% 94.5% n_eff Rhat4
#a[1]     8.50 0.01  8.49  8.50  3111     1
#a[2]     8.36 0.01  8.35  8.37  2850     1
#a[3]     8.22 0.01  8.21  8.23  3295     1
#a_bar    0.99 1.05 -0.64  2.67  1581     1
#sigma_a  5.11 1.37  3.33  7.47  1775     1
#sigma   87.91 5.11 80.00 96.21  1882     1

# run a CONTRAST to determine whether there is a difference between cities
post <- extract.samples(pop)
diff_a <- post$a[,1] - post$a[,2]
diff_p12 <- exp(post$a[,1]) - exp(post$a[,2]) #convert the log link to the probability scale p.341
diff_p13 <- exp(post$a[,1]) - exp(post$a[,3]) #convert the log link to the probability scale p.341
diff_p32 <- exp(post$a[,2]) - exp(post$a[,3]) #convert the log link to the probability scale p.341
precis( list( diff_p12=diff_p12 , diff_p13=diff_p13 , diff_p32=diff_p32 ) )
#        mean   sd  5.5% 94.5%     histogram
#diff_p12  612.15 36.01  556.47  670.68  ▁▁▁▂▃▇▇▇▅▂▁▁▁
#diff_p13 1184.74 36.10 1129.14 1241.31 ▁▁▁▁▂▃▇▇▅▃▁▁▁▁
#diff_p32  572.59 36.15  515.65  630.09  ▁▁▁▂▃▇▇▇▅▂▁▁▁
#there is a difference between all cities because diff interval crosses zero and there is a difference larger than 250 between the means

# summary
#mean(pd[pd$City=="Tempe",]$HumanPopDensity) #4282.755
#mean(pd[pd$City=="Woodland",]$HumanPopDensity) #3710.073
#mean(pd[pd$City=="Sacramento",]$HumanPopDensity) #4895.055
#sd(pd[pd$City=="Tempe",]$HumanPopDensity) #187.4377
#sd(pd[pd$City=="Woodland",]$HumanPopDensity) #140.2587
#sd(pd[pd$City=="Sacramento",]$HumanPopDensity) #185.2717

### land cover classifications (https://www.usgs.gov/media/images/land-cover-conterminous-us-shown-16-thematic-classes)
## Tempe and Sacramento = Developed, medium intensity
## Woodland = Cultivated crops
```

### P8: flexible = particular habitats

**Analysis:** We examine the proportion of focal follows associated with each microhabitat per individual and relate this to their flexibility scores on their most recent reversal in the tube experiment. This allows us to see whether the more flexible individuals (faster to reverse) are associated with particular microhabitats more than the less flexible individuals.

There is not a strong relationship between phi or lambda and the proportion of focal follows in a given micro habitat type: the compatibility intervals for the slopes cross zero in all microhabitat types (Table, Figure).

**Table.** Model output showing that phi and lambda did not have a strong relationship with the proportion of focal follows in a given microhabitat type for either sex as indicated by the slopes. n_eff is the effective sample size and Rhat4 is an indicator of model convergence (1.00 is ideal).

```{r resltsp8table, eval=T}
library(kableExtra)
t8 <- read.csv(url("https://raw.githubusercontent.com/corinalogan/grackles/master/Files/Preregistrations/g_flexforaging_tablep8.csv"), header=F, sep=",", stringsAsFactors=F)
t8 <- data.frame(t8)
colnames(t8) <- c("","Mean","Standard deviation","Lower 89 percentile compatibility interval (5.5%)","Upper 89 percentile compatibility interval (94.5%)","n_eff","Rhat4")

knitr::kable(t8) %>%
kable_styling(full_width = T, position = "left",  bootstrap_options = "condensed", font_size = 11)
```


```{r p8, eval=F}
library(rethinking)
d8 <- read.csv(url("https://raw.githubusercontent.com/corinalogan/grackles/master/Files/Preregistrations/g_flexforaging_data_proportionmicrohabitats.csv"), header=T, sep=",", stringsAsFactors=F)
d8 <- data.frame(d8)

# remove NAs
d8 <- subset(d8,!(is.na(d8["ProportionFollows"])))
d8 <- subset(d8,!(is.na(d8["Phi"])))
d8 <- subset(d8,!(is.na(d8["Lambda"])))
d8 <- subset(d8,!(is.na(d8["Microhabitat"])))

#Separate the sexes
ff8 <- d8[d8$Sex=="F",]
mm8 <- d8[d8$Sex=="M",]

#Summary
ff8$BirdID <- as.factor(ff8$BirdID)
#length(levels(ff8$BirdID)) #9 females
mm8$BirdID <- as.factor(mm8$BirdID)
#length(levels(mm8$BirdID)) #26 males

# SIMULATE
n = 99 #99 rows / 9 microhabitat types = 11 individuals
ph = rnorm(n,mean=0,sd=1) #phi can range from 0 to 1, but standardize it by making mean=0 and SD=1. FYI avg phi for AZ grackles is about 0.06 and only goes up to 0.12 so this is a small number, hence the small sd to keep it in this low range. 
ha = rep(c(1:9),11) #go through all individuals 1 time (microhabitat is a categorical variable) 
slopes0 = rep(c(0,0,0,0,0,0,0,0,0),11) #repeat 0 nine times (one time per habitat) for 11 inds. Use zeros for no relationship. 
slopes1 = rep(c(-1,-1,-1,0,0,0,1,1,1),11) #use a mixture of slopes to simulate what happens at different values
pf = rnorm(n,mean=(0*ha + slopes1*ph),sd=0.5) #proportion follows
#plot(ha,pf,cex=ph*2) #Multiply by 2 so the tiny dots show up better
#plots look good - any relationship is possible, but all values are within the feasible range

# RUN THE MODEL on the actual data (similar to J.Q4 in ManyIndividuals: line 1024)
# MALES, phi. Set up data sheet for model
dat8 <- list(follows = mm8$ProportionFollows, 
            phi = standardize(mm8$Phi),
            lambda = standardize(mm8$Lambda),
            hab = as.factor(mm8$Microhabitat)
              )

# Run the model
d8phi <- ulam( alist(
        follows ~ dbinom(1,p),
        logit(p) <- a[hab] + b[hab]*phi , #microhabitat=random variable
        a[hab] ~ dnorm(0,1), #mean=0 bc response variable is standardized
        b[hab] ~ dnorm(0,1)  #mean=0 bc response variable is standardized
    ) , data=dat8 , chains=4 , cores=4 , cmdstan = TRUE, control = list(adapt_delta = .95, force_recompile = TRUE))

outputd8p <- precis( d8phi , depth=2 ) #look at the b values (the slopes) and whether the interval crosses zero to determine whether phi is strongly related to the proportion of follows (does not cross 0) or not (does cross 0). b1=building, b2=dumpster, b3=grass, b4=human surface, b5=misc human, b6=natural ground, b7=rock, b8=shrub, b9=tree
#        mean   sd  5.5% 94.5% n_eff Rhat4
#b[1] -0.02 0.58 -0.96  0.90  2345     1
#b[2]  0.23 0.54 -0.62  1.10  3214     1
#b[3] -0.02 0.61 -1.00  0.93  2660     1
#b[4] -0.27 0.55 -1.16  0.57  2854     1
#b[5] -0.01 0.59 -0.97  0.92  2987     1
#b[6] -0.02 0.57 -0.92  0.89  2601     1
#b[7] -0.03 0.57 -0.94  0.90  2815     1
#b[8] -0.02 0.58 -0.96  0.88  2693     1
#b[9] -0.33 0.47 -1.07  0.42  2810     1
# The result here and for all of the below models is the same: the b intervals cross zero in all microhabitat types and the slope is negative, so not much relationship between phi and the proportion of follows, indicating that the more flexible individuals do not specialize in a particular microhabitat type

# MALES, lambda
d8lam <- ulam( alist(
        follows ~ dbinom(1,p),
        logit(p) <- a[hab] + b[hab]*lambda , #microhabitat=random variable
        a[hab] ~ dnorm(0,1), #mean=0 bc response variable is standardized
        b[hab] ~ dnorm(0,1)  #mean=0 bc response variable is standardized
    ) , data=dat8 , chains=4 , cores=4 , cmdstan = TRUE, control = list(adapt_delta = .95, force_recompile = TRUE))

outputd8l <- precis( d8lam , depth=2 )
#       mean   sd  5.5% 94.5% n_eff Rhat4
#b[1] -0.08 0.59 -1.04  0.84  2610     1
#b[2] -0.26 0.56 -1.18  0.59  2123     1
#b[3] -0.08 0.58 -1.09  0.80  2531     1
#b[4] -0.11 0.56 -1.01  0.75  3014     1
#b[5] -0.07 0.58 -1.03  0.81  1705     1
#b[6] -0.08 0.58 -1.10  0.81  2744     1
#b[7] -0.07 0.57 -0.99  0.83  3115     1
#b[8] -0.09 0.59 -1.06  0.77  2644     1
#b[9]  0.42 0.45 -0.28  1.12  2415     1
#look at b9 Tree because it has a large mean relative to the others
#plot(mm8[mm8$Microhabitat=="Tree",]$ProportionFollows ~ mm8[mm8$Microhabitat=="Tree",]$Lambda)
#this relationship is pretty randomly scattered, with the zero proportions having lower lambdas

# FEMALES, phi
daf8 <- list(follows = ff8$ProportionFollows, 
            phi = standardize(ff8$Phi),
            lambda = standardize(ff8$Lambda),
            hab = as.factor(ff8$Microhabitat)
              )

df8phi <- ulam( alist(
        follows ~ dbinom(1,p),
        logit(p) <- a[hab] + b[hab]*phi , #microhabitat=random variable
        a[hab] ~ dnorm(0,1), #mean=0 bc response variable is standardized
        b[hab] ~ dnorm(0,1)  #mean=0 bc response variable is standardized
    ) , data=daf8 , chains=4 , cores=4 , cmdstan = TRUE, control = list(adapt_delta = .95, force_recompile = TRUE))

outputdfp <- precis( df8phi , depth=2 ) 
#      mean   sd  5.5% 94.5% n_eff Rhat4
#b[1] -0.12 0.73 -1.32  0.98  3283     1
#b[2] -0.11 0.72 -1.29  0.99  2439     1
#b[3] -0.13 0.71 -1.28  0.94  2915     1
#b[4] -0.11 0.70 -1.28  0.99  3604     1
#b[5] -0.26 0.71 -1.45  0.82  3307     1
#b[6] -0.11 0.67 -1.21  0.94  2994     1
#b[7] -0.09 0.71 -1.34  0.98  2787     1
#b[8] -0.11 0.71 -1.28  0.98  3012     1
#b[9] -0.29 0.72 -1.50  0.78  3101     1

df8lam <- ulam(alist(
        follows ~ dbinom(1,p),
        logit(p) <- a[hab] + b[hab]*lambda , #microhabitat=random variable
        a[hab] ~ dnorm(0,1), #mean=0 bc response variable is standardized
        b[hab] ~ dnorm(0,1)  #mean=0 bc response variable is standardized
    ) , data=daf8 , chains=4 , cores=4 , cmdstan = TRUE, control = list(adapt_delta = .95, force_recompile = TRUE))

outputdfl <- precis( df8lam , depth=2 ) #look at the bp effect size and whether the interval crosses zero to determine whether 
#       mean   sd  5.5% 94.5% n_eff Rhat4
#b[1] -0.03 0.67 -1.10  1.01  2861     1
#b[2] -0.01 0.67 -1.07  1.02  2932     1
#b[3] -0.06 0.71 -1.23  1.03  2212     1
#b[4] -0.04 0.69 -1.18  1.04  2739     1
#b[5]  0.56 0.66 -0.47  1.62  2977     1
#b[6] -0.02 0.69 -1.14  1.06  2949     1
#b[7]  0.00 0.67 -1.10  1.06  3289     1
#b[8] -0.02 0.67 -1.09  1.02  2355     1
#b[9] -0.09 0.66 -1.12  0.96  2884     1

#look at b5 MiscHuman because it has a large mean relative to the others
#plot(ff8[ff8$Microhabitat=="MiscHuman",]$ProportionFollows ~ ff8[ff8$Microhabitat=="MiscHuman",]$Lambda)
#this relationship is due to 1 female that spends 100% of her time in this habitat, while the others don't often visit it

# put all of the model outputs into a csv file
#write.csv(c(outputdfp,outputdfl,outputd8l,outputd8l),file="flexforaging_P8outputs.csv")
```

```{r p8figure, eval=T}
library(ggplot2)
library(cowplot)

d8 <- read.csv(url("https://raw.githubusercontent.com/corinalogan/grackles/master/Files/Preregistrations/g_flexforaging_data_proportionmicrohabitats.csv"), header=T, sep=",", stringsAsFactors=F)
d8 <- data.frame(d8)

# remove NAs
d8 <- subset(d8,!(is.na(d8["ProportionFollows"])))
d8 <- subset(d8,!(is.na(d8["Phi"])))
d8 <- subset(d8,!(is.na(d8["Lambda"])))
d8 <- subset(d8,!(is.na(d8["Microhabitat"])))

#Separate the sexes
ff8 <- d8[d8$Sex=="F",]
mm8 <- d8[d8$Sex=="M",]
ff8$BirdID <- as.factor(ff8$BirdID)
mm8$BirdID <- as.factor(mm8$BirdID)

# factor categorical variable
ff8$Microhabitat <- as.factor(ff8$Microhabitat)
mm8$Microhabitat <- as.factor(mm8$Microhabitat)

# visualize
mp <- ggplot() + geom_point(data=mm8,aes(x=Microhabitat, y=ProportionFollows, size=Phi), shape=1) + geom_jitter(width=0.5, height=0.1) + theme(axis.text.x = element_text(angle=90, vjust = 0.5)) + labs(x = "", y = "Proportion follows")
ml <- ggplot() + geom_point(data=mm8,aes(x=Microhabitat, y=ProportionFollows, size=Lambda), shape=1) + geom_jitter(width=0.5, height=0.1) + theme(axis.text.x = element_text(angle=90, vjust = 0.5)) + labs(x = "", y = "")
fp <- ggplot() + geom_point(data=ff8,aes(x=Microhabitat, y=ProportionFollows, size=Phi), shape=1) + geom_jitter(width=0.5, height=0.1) + theme(axis.text.x = element_text(angle=90, vjust = 0.5)) + labs(x = "", y = "Proportion follows")
fl <- ggplot() + geom_point(data=ff8,aes(x=Microhabitat, y=ProportionFollows, size=Lambda), shape=1) + geom_jitter(width=0.5, height=0.1) + theme(axis.text.x = element_text(angle=90, vjust = 0.5)) + labs(x = "", y = "")

theme_set(theme_cowplot(font_size=12))
plot_grid(mp, ml, fp, fl, align='h', ncol=2, labels=c('A','B','C','D'), label_size=12)
```

**Figure.** Scatterplots for females (top row) and males (bottom row) showing the relationship between the proportion of follows in a particular microhabitat and phi (left column) or lambda (right column). Larger diameter circles indicate a larger phi or lambda.


## DISCUSSION

Human population density varies within and between the grackle populations: it is the highest and lowest at the Woodland trap sites, which are different from each other and from Tempe. This indicates that the environments that individuals on the edge experience do not differ systematically in human population density.

In conclusion,


## ETHICS

This research was carried out in accordance with permits from:

1) US Fish and Wildlife Service (scientific collecting permit number MB76700A-0,1,2)
2) US Geological Survey Bird Banding Laboratory (federal bird banding permit number 23872)
3) Arizona Game and Fish Department (scientific collecting license number SP594338 [2017], SP606267 [2018], and SP639866 [2019])
4) California Department of Fish and Wildlife (scientific collecting permit number S‐192100001‐19210‐001)
5) Institutional Animal Care and Use Committee at Arizona State University (protocol number 17-1594R)
6) Institutional Animal Care and Use Committee at the University of California Santa Barbara (protocol number 958)
7) University of Cambridge ethical review process (non-regulated use of animals in scientific procedures: zoo4/17 [2017])
8) RegionalSan access permit (number AP 2021-01)

## AUTHOR CONTRIBUTIONS

**Logan:** Hypothesis development, study design, materials, data collection, data analysis and interpretation, write up, funding.

**Lukas:** Hypothesis development, study design, data analysis and interpretation, write up, revising/editing.

**LeGrande-Rolls:** Data collection, data analysis and interpretation, revising/editing

**Bergeron:** Data collection, data interpretation, revising/editing.

**Folsom:** Data collection, data interpretation, revising/editing.

**Marfori:** Data collection, revising/editing.

**McCune:** Hypothesis development, study design, data collection, data analysis, data interpretation, revising/editing.

## FUNDING

This research was funded by the Department of Human Behavior, Ecology and Culture at the Max Planck Institute for Evolutionary Anthropology, and by a Leverhulme Early Career Research Fellowship to Logan (2017-2018).

## CONFLICT OF INTEREST DISCLOSURE

We, the authors, declare that we have no financial conflicts of interest with the content of this article. Logan and Lukas are Recommenders at PCI Ecology, and Logan was on the Managing Board at PCI Ecology (2018-2022).

## ACKNOWLEDGEMENTS

We thank Ben Trumble for providing us with a wet lab at Arizona State University and Angela Bond for lab support; Melissa Wilson for sponsoring our affiliations at Arizona State University and lending lab equipment; Kevin Langergraber for serving as local PI on the ASU IACUC; Kristine Johnson for technical advice on great-tailed grackles; Arizona State University School of Life Sciences Department Animal Care and Technologies for providing space for our aviaries and for their excellent support of our daily activities; Julia Cissewski for tirelessly solving problems involving financial transactions and contracts; Richard McElreath for project support; Aaron Blackwell and Ken Kosik for being the UCSB sponsors of the Cooperation Agreement with the Max Planck Institute for Evolutionary Anthropology; Julia Astegiano, our Recommender at PCI Ecology, and reviewers Esther Sebastian-Gonzalez and Pizza Ka Yee Chow for their wonderful feedback; Sawyer Lung for field support; Alexis Breen for assistance with data cleaning; and our research assistants: Aelin Mayer, Nancy Rodriguez, Brianna Thomas, Aldora Messinger, Elysia Mamola, Michael Guillen, Rita Barakat, Adriana Boderash, Olateju Ojekunle, August Sevchik, Justin Huynh, Jennifer Berens, Amanda Overholt, Michael Pickett, Sam Munoz, Sam Bowser, Emily Blackwell, Kaylee Delcid, Sofija Savic, Brynna Hood, Sierra Planck, and Elise Lange.

\newpage

## SUPPLEMENTARY MATERIAL 1: interobserver reliability

To be able to conduct focal follows [methods as in @altmann1974observational], a coder must pass interobserver reliability before the data they collect is used in the data set. To pass, coders must have an intra-class correlation [ICC; @hutcheon2010random] of 0.90 or greater based on at least six 10-min focal follows where both coders recorded the behavior of the same focal individual at the same time.

Bergeron was the first person to conduct focal follows, therefore she trained McCune and Folsom until they passed interobserver reliability (on 10 June 2019) for each of the 6 variables listed in the preregistration. In March 2021, Rolls passed interobserver reliability (training with McCune) in the California population.

```{r ior, eval=FALSE, warning=FALSE, results='asis', echo=TRUE, include=TRUE}
# Inter/intra-rater reliability using Cohen's kappa when the variable is categorical (scale=1+) or intra-class correlation coefficient when the variable is continuous (Mandrekar 2011 J Thoracic Oncology 6(1):6-7 https://doi.org/10.1097/JTO.0b013e318200f983)

# Intra-class correlation / reliability coefficient / the
# degree of bias in the regression slope (Hutcheon et al.
# 2010. Random measurement error and regression dilution bias
# www.bmj.com/content/340/bmj.c2289). 'The ratio of variation
# in error-free (true) X values to the variation in the
# observed error-prone (observed) values is known as the
# reliability coefficient, attenuation factor, or intra-class
# correlation.'

#Cohen's kappa = Good for nominal data (where distance doesn't mean anything; don't use the weighted Kappa bc it is like the ICC) https://www.rdocumentation.org/packages/psych/versions/1.9.12.31/topics/cohen.kappa 

# ICC / Cohen's Kappa must be 0.90 or greater to be considered reliable and pass training
### ICCs for agreement between the 2 coders (live coder and video coder)

library(irr) #ICC package
library(psych) #Cohen's kappa package

### ICCs & Cohen's unweighted kappas for agreement between the 2 coders for 6-7 variables
#Note: c(4,5) is telling R to look at columns 4 ("1NumberForagingTechniques") and 5 ("2NumberForagingTechniques") and compare them

#ICCs for KM=Kelsey McCune, MF=Melissa Folsom, CLR=Christa Rolls
km <- read.csv(url("https://raw.githubusercontent.com/corinalogan/grackles/master/Files/Preregistrations/IOR_flexforagingKM.csv"), header=T, sep=",", stringsAsFactors=F) 
km #Check to make sure it looks right
km[,2]
km[,3]

#ICC for number different foods eaten not working
icc(km[,c(2,3)], model="oneway", type="agreement", unit="single", conf.level=0.95) #NumberDifferentFoodsEaten. See note in text for why this is 1.00 rather than 0.64

icc(km[,c(4,5)], model="oneway", type="agreement", unit="single", conf.level=0.95) #NumberDifferentForagingTechniques
icc(km[,c(6,7)], model="oneway", type="agreement", unit="single", conf.level=0.95) #NumberAffiliativeInteractions
icc(km[,c(8,9)], model="oneway", type="agreement", unit="single", conf.level=0.95) #NumberAggressiveInteractions
icc(km[,c(10,11)], model="oneway", type="agreement", unit="single", conf.level=0.95) #NumberTimesSubjectInitiatedAggression
cohen.kappa(km[,c(12,13)], w=NULL,n.obs=NULL,alpha=.05,levels=NULL) #Microhabitat


#ICCs for MF=Melissa Folsom
mf <- read.csv(url("https://raw.githubusercontent.com/corinalogan/grackles/master/Files/Preregistrations/IOR_flexforagingMF.csv"), header=T, sep=",", stringsAsFactors=F) 
mf #Check to make sure it looks right
mf[,2]
mf[,3]
mf[,12]
mf[,13]

icc(mf[,c(2,3)], model="oneway", type="agreement", unit="single", conf.level=0.95) #NumberDifferentFoodsEaten. See note in text for why this is 1.00 rather than 0.63
icc(mf[,c(4,5)], model="oneway", type="agreement", unit="single", conf.level=0.95) #NumberDifferentForagingTechniques
icc(mf[,c(6,7)], model="oneway", type="agreement", unit="single", conf.level=0.95) #NumberAffiliativeInteractions
icc(mf[,c(8,9)], model="oneway", type="agreement", unit="single", conf.level=0.95) #NumberAggressiveInteractions
icc(mf[,c(10,11)], model="oneway", type="agreement", unit="single", conf.level=0.95) #NumberTimesSubjectInitiatedAggression
cohen.kappa(mf[,c(12,13)], w=NULL,n.obs=NULL,alpha=.05,levels=NULL) #Microhabitat


#ICCs for CLR=Christa Rolls
clr <- read.csv(url("https://raw.githubusercontent.com/corinalogan/grackles/master/Files/Preregistrations/IOR_flexforagingCLR.csv"), header=T, sep=",", stringsAsFactors=F) 
clr #Check to make sure it looks right
clr[,9]
clr[,10]

icc(clr[,c(3,4)], model="oneway", type="agreement", unit="single", conf.level=0.95) #NumberDifferentFoodsEaten
icc(clr[,c(5,6)], model="oneway", type="agreement", unit="single", conf.level=0.95) #NumberDifferentForagingTechniques
icc(clr[,c(7,8)], model="oneway", type="agreement", unit="single", conf.level=0.95) #NumberAffiliativeInteractions
icc(clr[,c(9,10)], model="oneway", type="agreement", unit="single", conf.level=0.95) #NumberAggressiveInteractions
icc(clr[,c(11,12)], model="oneway", type="agreement", unit="single", conf.level=0.95) #NumberTimesSubjectInitiatedAggression
cohen.kappa(clr[,c(13,14)], w=NULL,n.obs=NULL,alpha=.05,levels=NULL) #Microhabitat. Unweighted kappa=1
icc(clr[,c(15,16)], model="oneway", type="agreement", unit="single", conf.level=0.95) #Group size
```

**Scores for McCune (n=6 focal follows, Bergeron=baseline):**

Different Foods Eaten: ICC = 1.00

Different Foraging Techniques: ICC = 0.97 (95% confidence interval=0.823-1.00)

Number of Affiliative Interactions: ICC = 0.96 (95% confidence interval=0.794-1.00)

Number of Aggressive Interactions: ICC = 1.00 (95% confidence interval=0.986-1.00)

Number of Initiated Aggressive Interactions: ICC = 1.00 (95% confidence interval=0.974-1.00)

Microhabitat: Cohen's unweighted kappa = 1.00

**Scores for Folsom (n=6 focal follows, Bergeron=baseline):**

Different Foods Eaten: ICC = 1.00

Different Foraging Techniques: ICC = 1.00

Number of Affiliative Interactions: ICC = 1.00

Number of Aggressive Interactions: ICC = 0.96 (95% confidence interval=0.779-0.994)

Number of Initiated Aggressive Interactions: ICC = 0.94 (95% confidence interval=0.696-0.991)

Microhabitat: Cohen's unweighted kappa = 1.00

NOTE: the ICCs for the variable Different Foods Eaten for these focal follows was originally 0.63 (Folsom) and 0.64 (McCune) because Folsom and McCune recorded a "bug" being eaten while Bergeron recorded no food type because she couldn't identify it to a more specific category. At this point, we decided that we would prefer to enter a general category for food type rather than having no information about what was eaten. Therefore, this data point was removed from the interobserver reliability analysis. This resulted in ICCs of 1.00 for both McCune and Folsom on the Different Foods Eaten variable because they matched Bergeron in the other food type data points.

**Scores for Rolls (n=17 focal follows, McCune=baseline):**

Different Foods Eaten: ICC = 0.92 (95% confidence interval=0.791-0.971)

Different Foraging Techniques: ICC = 0.91 (95% confidence interval=0.758-0.966)

Number of Affiliative Interactions: ICC = 0.90 (95% confidence interval=0.751-0.965)

Number of Aggressive Interactions: ICC = 0.94 (95% confidence interval=0.830-0.977)

Number of Initiated Aggressive Interactions: ICC = 0.95 (95% confidence interval=0.874-0.983)

Microhabitat: Cohen's unweighted kappa = 1.00

Group size = 1.00

```{r iorrolls, eval=FALSE, warning=FALSE, results='asis', echo=TRUE, include=TRUE}
#Cohen's kappa for CLR=Christa Rolls' recoded data vs the original transcribed data
library(psych) #Cohen's kappa package

#whether one or more errors were found by CLR (1=yes, 0=no). The assumption is that when the coders initially transcribed the data the first time, they did not think they were making any errors (0)
clr = c(1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0)
orig = c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)

#the cohen.kappa calculation can't calculate it properly when the data are in this format because one string is calculating the errors of the other string. So assign numbers 1 through 37 to orig and the same for clr, but make the 4 data points that were different in the two strings a number that is out of sequence so the difference will register
orig <- c(1:37)
clr <- c(1:37)
clr[1] <- 38
clr[22] <- 39
clr[30] <- 10
clr[36] <- 40

cohen.kappa(x=cbind(clr,orig), w=NULL,n.obs=NULL,alpha=.05,levels=NULL) #Unweighted kappa = 0.89, confidence boundary 0.79-0.99
```

**Unregistered reliability analysis for data entry (Jun 2022):** The focal follow data were transferred from the Prim8 auto-generated data sheets and transcribed (from focals that were recorded using audio files) to two analyzable data sheets (one for social behavior and one for foraging behavior) containing data for all variables in this preregistration. During the data cleaning process, several data entry/transcription errors were found, which prompted us to conduct a reliability analysis on the data. We did not record who the data entry person / transcriber was, so we could not conduct an interoberver analysis. Instead, we conducted an intraobserver reliability analysis. Ten percent (37) of the focal follows (total 367) were randomly selected (using RAND() in MS Excel) and recoded by Christa Rolls in 2022. Rolls recorded for each focal follow whether one or more errors in the original data set were made (1) or not (0), and this vector was compared with a vector from the original data set where the assumption wsa that no errors were made (all data points were 0). The Cohen's kappa between the recoded and the original data set was 0.89 (confidence boundary 0.79-0.99), indicating that the data cleaning process corrected enough errors such that the rest of the data did not need to be recoded.

## REFERENCES
